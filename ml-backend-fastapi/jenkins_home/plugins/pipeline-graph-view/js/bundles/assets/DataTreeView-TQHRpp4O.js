(function(){"use strict";try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode('#tasks{margin:0;padding-right:.7rem}.pgw-filter-bar{position:relative;display:grid;grid-template-columns:1fr auto;margin-bottom:.75rem}.pgw-filter-bar:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border-radius:var(--form-input-border-radius);border:var(--jenkins-border, 2px solid color-mix(in srgb, var(--text-color-secondary) 10%, transparent));box-shadow:var(--form-input-glow);transition:var(--standard-transition)}.pgw-filter-bar button{border-radius:.4rem;padding-inline:0;width:42px}.pgw-filter-bar button:before,.pgw-filter-bar button:after{top:5px;right:5px;bottom:5px;left:5px}.pgw-filter-bar .jenkins-search{--search-bar-height: 2.625rem}.pgw-filter-bar .jenkins-search input{border:none!important;box-shadow:none!important;background:none!important;padding:0 0 0 var(--search-bar-height)}.pgw-filter-bar:hover:before{border-color:var(--input-border-hover)}.pgw-filter-bar:has(input:focus):before{border-color:var(--focus-input-border);box-shadow:var(--form-input-glow--focus)}.pgv-tree-item{display:block!important;font-family:var(--font-family-sans)!important;padding-block:.5rem!important;padding-right:1rem;cursor:pointer!important}.pgv-tree-item>div{display:flex;align-items:center;justify-content:stretch;text-wrap:nowrap;text-overflow:ellipsis;white-space:nowrap;gap:.65rem;-webkit-mask-image:linear-gradient(90deg,white calc(100% - 2.5rem),transparent calc(100% - 1rem));mask-image:linear-gradient(90deg,white calc(100% - 2.5rem),transparent calc(100% - 1rem))}.pgv-tree-item .task-icon-link>div{display:contents}.pgv-tree-item svg{flex-shrink:0}.pgv-tree-item__description{color:var(--text-color-secondary)}.pgv-tree-item--skeleton{pointer-events:none;color:var(--text-color-secondary)!important}.pgv-toggle-icon{position:absolute;top:.6875rem;right:.55rem;width:1rem;height:1rem;margin-left:auto;transition:var(--standard-transition);-webkit-appearance:none;-moz-appearance:none;appearance:none;background:none;padding:0;border:none;cursor:pointer;color:var(--text-color-secondary)}.pgv-toggle-icon--active{rotate:90deg}.pgv-toggle-icon svg{width:1rem;height:1rem}.pgv-toggle-icon svg *{stroke-width:42px!important}.pgv-toggle-icon:hover{color:var(--text-color)}.pgv-tree-node-header{position:relative}.pgv-tree-children{position:relative;display:flex;flex-direction:column;gap:.125rem;margin-top:.125rem;padding-left:calc(2.725rem + var(--jenkins-border-width, 2px));padding-right:.7rem}.pgv-tree-children:before{content:"";position:absolute;top:.375rem;left:calc(1.3875rem - var(--jenkins-border-width, 2px) / 2);bottom:.375rem;background-color:var(--jenkins-border-color, color-mix(in srgb, var(--text-color-secondary) 25%, transparent));width:var(--jenkins-border-width, 2px);border-radius:var(--form-input-border-radius)}.pgv-filter-button{transition:var(--standard-transition)}.pgv-filter-button svg{width:1.375rem;height:1.375rem}.pgv-filter-button--unchecked{opacity:.75;color:var(--text-color-secondary)!important}.jenkins-dropdown__heading{display:grid;grid-template-columns:1fr auto}.pgv-reset-button{padding:0;min-height:0}.pgv-reset-button:before,.pgv-reset-button:after{display:none}')),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
import{r as x,R as u,j as e,H as C}from"./connections-Dcx8uABw.js";import{a as N,i as S,S as b,T as y}from"./timings-DQC4RGf4.js";import{D as _,c as j}from"./dropdown-C14wRVOb.js";import{u as m}from"../pipeline-console-view-bundle.js";function M({disabled:d}){const[t,i]=x.useState(!1),{visibleStatuses:s,toggleStatus:l,resetStatuses:h,allVisible:o}=m(),p=[{key:"running",text:"Running",status:u.running},{key:"success",text:"Successful",status:u.success},{key:"failure",text:"Failed",status:u.failure},{key:"unstable",text:"Unstable",status:u.unstable},{key:"aborted",text:"Aborted",status:u.aborted},{key:"skipped",text:"Skipped",status:u.skipped},{key:"not_built",text:"Not built",status:u.not_built}],r=()=>i(!0),a=()=>i(!1);return e.jsx(N,{content:"Filter",children:e.jsx(S,{..._,visible:t,onClickOutside:a,placement:"bottom",appendTo:document.body,offset:[0,-1],content:e.jsxs("div",{className:"jenkins-dropdown",children:[e.jsxs("div",{className:"jenkins-dropdown__heading",children:["Filter",!o&&e.jsx("button",{className:"jenkins-button jenkins-button--tertiary jenkins-!-accent-color pgv-reset-button",onClick:h,children:"Reset"})]}),p.map((c,k)=>e.jsxs("button",{className:j("jenkins-dropdown__item","pgv-filter-button",{"pgv-filter-button--unchecked":!s.includes(c.status)}),onClick:()=>l(c.status),children:[e.jsx("div",{className:"jenkins-dropdown__item__icon",children:e.jsx(b,{status:c.status,skeleton:!s.includes(c.status),percentage:0})}),c.text]},k))]}),children:e.jsx("button",{className:j("jenkins-button",{"jenkins-button--tertiary":o},{"jenkins-!-accent-color":!o}),type:"button",disabled:d,onClick:t?a:r,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:o?36:42,d:"M32 144h448M112 256h288M208 368h96"})})})})})}function R({stages:d,selected:t,onNodeSelect:i}){const{search:s,setSearch:l,visibleStatuses:h}=m(),o=f(s,h,d),p=x.useCallback((r,a)=>{i(r,a)},[i]);return e.jsxs("div",{children:[e.jsxs("div",{className:"pgw-filter-bar",children:[e.jsxs("div",{className:"jenkins-search",children:[e.jsx("div",{className:"jenkins-search__icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M221.09 64a157.09 157.09 0 10157.09 157.09A157.1 157.1 0 00221.09 64z",fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M338.29 338.29L448 448"})]})}),e.jsx("input",{className:"jenkins-input jenkins-search__input",placeholder:"Search",type:"search",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:s,onChange:r=>l(r.target.value)})]}),e.jsx(M,{})]}),o.length===0&&e.jsxs("div",{className:"jenkins-notice",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:36,d:"M32 144h448M112 256h288M208 368h96"})}),e.jsx("div",{children:"No stages"})]}),e.jsx("div",{id:"tasks",style:{marginLeft:"0.7rem"},children:o.map(r=>e.jsx(L,{stage:r,selected:String(t),onSelect:p},r.id))})]})}const L=C.memo(function d({stage:t,selected:i,onSelect:s}){const{search:l,visibleStatuses:h,allVisible:o}=m(),p=t.children&&t.children.length>0,r=String(t.id)===i,[a,c]=x.useState(k(t));function k(n){var v;return(v=n.children)==null?void 0:v.some(g=>String(g.id)===i||k(g))}const w=n=>{n.stopPropagation(),c(!a)};return x.useEffect(()=>{(l.length||!o)&&f(l,h,[t]).length!==0&&c(!0)},[l,h,o]),e.jsxs("div",{className:"task",children:[e.jsxs("div",{className:"pgv-tree-node-header",children:[e.jsx("a",{href:"?selected-node="+t.id,onClick:n=>{n.button!==0||n.metaKey||n.ctrlKey||(n.preventDefault(),history.replaceState({},"","?selected-node="+t.id),r||s(n,String(t.id)),c(!a))},className:j("pgv-tree-item","task-link",{"task-link--active":r,"pgv-tree-item--skeleton":t.skeleton}),children:e.jsxs("div",{children:[e.jsx("span",{className:"task-icon-link",children:e.jsx(b,{status:t.state,percentage:t.completePercent,skeleton:t.skeleton})}),e.jsx("span",{className:"task-link-text",children:t.name}),t.state===u.running&&e.jsx("span",{className:"pgv-tree-item__description",children:e.jsx(y,{ms:t.totalDurationMillis})})]})}),p&&e.jsx("button",{className:j("pgv-toggle-icon",{"pgv-toggle-icon--active":a}),onClick:w,"aria-label":a?"Collapse":"Expand",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M184 112l144 144-144 144"})})})]}),p&&a&&e.jsx("div",{className:"pgv-tree-children",children:t.children.map(n=>e.jsx(d,{stage:n,selected:i,onSelect:s},n.id))})]})}),f=(d,t,i)=>i.map(s=>{const l=s.children?f(d,t,s.children):[];return s.name.toLowerCase().includes(d.toLowerCase())&&t.includes(s.state)||l.length>0?{...s,children:l}:null}).filter(s=>s!==null);export{R as default};
//# sourceMappingURL=DataTreeView-TQHRpp4O.js.map
