<div th:fragment="chatbotFragment">
    <!-- Chatbot FAB -->
    <div class="chatbot-fab" onclick="toggleChat()">
        <svg viewBox="0 0 24 24">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
        </svg>
    </div>

    <!-- Chat Window -->
    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <h4>청약Fit AI 상담사</h4>
            <button onclick="toggleChat()" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">×</button>
        </div>
        <div class="chat-body">
            <div style="background: #f1f3f4; padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                안녕하세요! 청약과 대출에 대해 궁금하신 점이 있으신가요? 무엇이든 물어보세요! 😊
            </div>
        </div>
        <div class="chat-input-container">
            <input type="text" class="chat-input" placeholder="메시지를 입력하세요...">
            <button class="chat-send">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                </svg>
            </button>
        </div>
    </div>
</div>

<script th:fragment="chatbotScript">
    // Toggle chat window
    function toggleChat() {
        const chatWindow = document.getElementById('chatWindow');
        chatWindow.classList.toggle('active');
    }

    // Chat functionality
    document.querySelector('.chat-send').addEventListener('click', function() {
        const input = document.querySelector('.chat-input');
        const chatBody = document.querySelector('.chat-body');

        if (input.value.trim()) {
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.style.cssText = 'background: #e3f2fd; padding: 1rem; border-radius: 12px; margin-bottom: 1rem; text-align: right;';
            userMessage.textContent = input.value;
            chatBody.appendChild(userMessage);

            // Simulate AI response
            setTimeout(() => {
                const aiMessage = document.createElement('div');
                aiMessage.style.cssText = 'background: #f1f3f4; padding: 1rem; border-radius: 12px; margin-bottom: 1rem;';
                aiMessage.textContent = '네, 무엇을 도와드릴까요? 청약이나 대출에 대해 자세히 알려드리겠습니다.';
                chatBody.appendChild(aiMessage);
                chatBody.scrollTop = chatBody.scrollHeight;
            }, 1000);

            input.value = '';
            chatBody.scrollTop = chatBody.scrollHeight;
        }
    });

    // Enter key for chat
    document.querySelector('.chat-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            document.querySelector('.chat-send').click();
        }
    });
</script>
